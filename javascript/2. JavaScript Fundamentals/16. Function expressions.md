# Function expressions

JavaScript는 함수를 특별한 종류의 값으로 취급합니다. 다른 언어에서처럼 특별한 동작을 하는 구조로 취급되지 않습니다.

```javascript
function sayHi(){
    alert("Hello");
}
```

함수 선언문외 함수 표현식(Function Expression)을 사용해서 함수를 만들 수 있습니다.

```javascript
let sayHi = function() {
    alert("Hello");
};
```

함수를 생성하고 변수에 값을 할당하는 것처럼 함수가 변수에 할당되었습니다. 함수가 어떤 방식으로 만들어 졌는지에 관계없이 함수는 값이고, 따라서 변수에 할당할 수 있습니다.

JavaScript에서 함수는 값입니다. 따라서 함수를 값처럼 취급할 수 있습니다. 함수는 `sayHi()`처럼 호출할 수 있다는 점 때문에 일반적인 값과는 조금 다릅니다. 특별한 종류의 값으로 취급 됩니다. 하지만 그 본질은 값이기 때문에 값에 할 수 있는 일을 함수에도 할 수 있습니다.

변수를 복사해 다른 변수에 할당하는 것처럼 함수를 복사해 다른 변수에 할당할 수 있습니다.

```javascript
function sayHi() {   // (1) 함수 생성
  alert( "Hello" );
}

let func = sayHi;    // (2) 함수 복사

func(); // Hello     // (3) 복사한 함수를 실행(정상적으로 실행됩니다)!
sayHi(); // Hello    //     본래 함수도 정상적으로 실행됩니다.
```

함수 표현식의 끝에 세미콜론이 붙는지 의문이 들수도 있습니다. 이는 함수 표현식은 `let sayHi = ...;`과 같은 구문 안에서 값의 역할을 하기 때문입니다. 코드 블록이 아니고 값처럼 취급되어 변수에 할당이됩니다. 즉 함수 표현식 때문에 붙여진게 아니라 구문의 끝이기 때문에 붙여졌습니다.

## 콜백 함수

함수를 값처럼 전달하는 예시, 함수 표션식에 관한 예시를 좀더 살펴 보겠습니다.

우선 매개변수가 3가지 있는 함수 `ask(question, yse, no)`를 작성하겠습니다. 각각의 매개변수에 대한 설명은 아래와 같습니다.

`question` : 질문

`yes` : "Yes"라고 답한 경우 실행되는 함수

`no` : "No"라고 답한 경우 실행되는 함수

함수는 반드시 `question`을 해야 하고, 사용자의 답변에 따라 `yes()`나 `no()`를 호출합니다.

```javascript
function ask(question, yes, no) {
  if (confirm(question)) yes()
  else no();
}

function showOk() {
  alert( "동의하셨습니다." );
}

function showCancel() {
  alert( "취소 버튼을 누르셨습니다." );
}

// 사용법: 함수 showOk와 showCancel가 ask 함수의 인수로 전달됨
ask("동의하십니까?", showOk, showCancel);
```

이렇게 함수를 작성하는 방법은 실무에서 아주 유용하게 쓰입니다. 면대면으로 질문하는 것보다 위처럼 컴펌창을 띄워 질문을 던지고 답변을 받으면 간단하게 설문조사를 진행할 수 있습니다. 실제 상용 서비스에선 컨펌 창을 좀더 멋지게 꾸미는 등의 작업이 동반됩니다.

**함수 `ask`의 인수, `showOK`와 `showCancel`은 콜백 함수 또는 콜백이라 부릅니다.**

함수를 함수의 인수로 전달하고, 필요하다면 인수로 전달한 그 함수를 "나중에 호출(called back)"하는 것이 콜백 함수의 개념입니다. 위 예시에선 사용자가 "yes"라고 대답한 경우 `showOK`가 콜백이 되고, "no"라고 대답한 경우 `showCancel`가 콜백이 됩니다.

아래와 같이 익명함수를 이용하여 코드 길이를 더 짧게 만들 수 있습니다.

```javascript
function ask(question, yes, no) {
  if (confirm(question)) yes()
  else no();
}

ask(
  "동의하십니까?",
  function() { alert("동의하셨습니다."); },
  function() { alert("취소 버튼을 누르셨습니다."); }
);
```
`ask(...)`안에 선언된 함수는 이름이 없이 선언한 `익명함수(anonymous function)` 입니다. 익명함수는 변수에 할당된 게 아니기 때문에 `ask` 바깥에선 접근할 수 없습니다.

자바스크립트를 사용하다 보면 콜백을 활용한 코드를 아주 자연스레 만나게 됩니다. 이런 코드는 자바스크립트의 정신을 대변합니다.

## 함수 표현식 vs 혐수 선언문

함수 표현식과 선언문의 차이에 대해 알아봅시다.

1. 문법
2. JavaScript 엔진의 함수 생성 시기
3. 스코프

**첫 번째**는 문법입니다.

- 함수 선언문
```javascript
function sum(a, b){
  return a + b;
}
```

- 함수 표현식
```javascript
let sum = function(a, b){
  return a + b;
};
```

**두 번째** 차이는 JavaScript엔진이 언제함수를 생성하는지에 있습니다.

**함수 표현식은 실제 실행 흐름이 해당 함수에 도달했을 때 함수를 생성합니다. 따라서 실행 흐름이 함수에 도달했을 때 부터 해당 함수를 사용할 수 있습니다.**

함수 선언문은 조금 다릅니다.

**함수 선언문은 함수 선언문이 정의되기 전에도 호출할 수 있습니다. 따라서 전역 함수 선언문은 스크립트 어디에 있느냐에 상관없이 어디에서든 사용할 수 있습니다.**

이게 가능한 이유는 JavaScript의 내부 알고리즘 때문입니다. JavaScript는 스크립트를 실행하기 전, 준비단계에서 전역에 선언된 함수 선언문을 찾고, 해당 함수를 생성합니다. 스크립트가 진짜 실행되기 전 초기화 단계에서 함수 언언 방식으로 정의한 함수가 생성 됩니다.

스크립트는 함수 선언문이 모두 처리된 이후에서야 실행됩니다. 따라서 스크립트 어디서든 함수 선언문으로 선언한 함수에 접근할 수 있습니다.

```javascript
sayHi("John"); // Hello, John

function sayHi(name) {
  alert( `Hello, ${name}` );
}
```

함수 선언문으로 선언된 `sayHi`는 스크립트 실행 준비 단계에서 생성되기 때문에 스크립트 내 어디에서든 접근할 수 있습니다.

```javascript
sayHi("John"); // error!

let sayHi = function(name) {
  alert( `Hello, ${name}` );
};
```

함수 표현식은 실행 흐름이 표현식에 다다랐을 때 만들어집니다. 

**세 번째** 차이점은 스코프입니다.

엄격 모드에서 함수 선언문이 코드 블록 내에 위치하면 해당 함수는 블록 내 어디서든 접근할 수 있습니다. 하지만 블록 밖에서는 함수에 접근하지 못합니다.

```javascript
let age = prompt("나이를 알려주세요.", 18);

// 조건에 따라 함수를 선언함
if (age < 18) {

  function welcome() {
    alert("안녕!");
  }

} else {

  function welcome() {
    alert("안녕하세요!");
  }

}

// 함수를 나중에 호출합니다.
welcome(); // Error: welcome is not defined
```

함수 선언문은 함수가 선언된 코드 블록 안에서만 유효하기 때문에 이런 에러가 발생합니다.

함수 표현식을 이용하면 블록 바깥에서 `let`을 먼저 선언하는 것으로 해결할 수 있습니다.
```javascript
let age = prompt("나이를 알려주세요.", 18);

let welcome;

if (age < 18) {

  welcome = function() {
    alert("안녕!");
  };

} else {

  welcome = function() {
    alert("안녕하세요!");
  };

}

welcome(); // 제대로 동작합니다.
```

이처럼 표현식을 이용할 수도 있습니다.

함수 선언문과 함수 표현식 중 무엇을 선택해야 할지에 대해서는 우선 함수 선언문을 고혀하는 것이 좋습니다. 함수 선언문으로 함수를 정의하면, 함수가 선언되기 전에 호출할 수 있어서 코드 구성을 좀 더 자유롭게 할 수 있습니다.

함수 선언문을 사용하면 가독성 또한 좋아집니다. 코드에서 `let f = function(...) {...}` 보다 `function(...) {...}`가 함수라는 것을 알아보기 더 쉽습니다. 자칫 잘못하면 일반 변수와 헷갈릴 수도 있습니다.

하지만 함수표현식이 필요한 경우라면 사용하는 것이 좋습니다.